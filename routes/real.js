var Db=require("../db"),$=require("jquery-deferred"),Purchase=require("../controllers/purchase");module.exports={"default":{params:{type:{required:!0},id:{required:!0,parseMethod:parseInt},real:{required:!0,parseMethod:parseInt}},handler:function(e,r){var s=r.type,a=r.id,u=r.real;if(!(GLOBAL.GYM.test||e.pendingPayment&&e.pendingPayment.amount==u))return $.Deferred(function(e){e.resolve({success:!1})});var n={success:!0,purchase:{type:s,id:a,success:!0}};Purchase.go(e,s,a,n,u);var t=$.Deferred();return e.pendingPayment=null,e.isDirty=!0,t.resolve(n),t}}};